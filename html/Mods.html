<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mods</title>
  <link rel="icon" type="image/x-icon" href="https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/Favicon-1.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Rubik&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --tw-overlay-1: rgba(0, 0, 0, 0.3);
      --tw-overlay-2: rgba(0, 0, 0, 0.3);
      --er-overlay-1: rgba(160, 160, 160, 0.08);
      --er-overlay-2: rgba(0, 0, 0, 0.3);

      --text-main: #eeebebbe;
      --text-strong: #ffffff;
      --tile-bg: rgba(96, 95, 95, 0.05);
      --tile-bg-hover: rgba(255, 255, 255, 0.055);
      --tile-highlight: rgba(128, 128, 128, 0.09);
      --badge-bg: rgba(120, 120, 120, 0.25);
      --badge-text: rgba(170, 170, 170, 0.8);
      --btn-bg: rgba(255, 255, 255, 0.05);
      --btn-bg-hover: rgba(255, 255, 255, 0.12);
      --arrow-color: #9b9b9bc9;
    }

    body {
      position: relative;
      font-family: 'Rubik', sans-serif;
      color: #eee;
      min-height: 100vh;
      overflow-x: hidden;
    }

    .bg-layer {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      background-attachment: fixed;
      z-index: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }

    #bg-tw {
      opacity: 1;
      background-image:
        linear-gradient(var(--tw-overlay-1), var(--tw-overlay-1)),
        linear-gradient(var(--tw-overlay-2), var(--tw-overlay-2)),
        url('https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/TotalWar_Background.png');
    }

    #bg-er {
      opacity: 1;
      background-image:
        linear-gradient(var(--er-overlay-1), var(--er-overlay-1)),
        linear-gradient(var(--er-overlay-2), var(--er-overlay-2)),
        url('https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/EldenRing_Background.png');
    }

    #particles-js {
      position: fixed;
      inset: 0;
      z-index: 1;
      pointer-events: none;
    }

    .content { position: relative; z-index: 2; }

    #tw-section,
    #elden-section {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      text-align: center;
      padding: 60px 20px 120px;
      color: white;
    }

    #tw-section #tw-customIcon,
    #elden-section #customIcon {
      height: 30%;
      width: auto;
      margin-bottom: 15px;
      user-select: none;
      filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.7));
    }

    .section {
      max-width: 920px;
      margin: 0 auto 44px auto;
      padding: 0 10px;
    }
    .section h1 {
      font-size: 24px;
      margin-bottom: 10px;
      color: var(--text-strong);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .section h1 img {
      height: 27px;
      vertical-align: middle;
      margin-bottom: 4px;
      margin-left: 15px;
      user-select: none;
      pointer-events: none;
    }

    .filelist-frame {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.09);
      border-radius: 16px;
      backdrop-filter: blur(6px) brightness(0.5);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.6);
      padding: 1px;
      max-width: 880px;
      margin: 0 auto;
      width: 700px;
      height: auto;
      overflow: auto;
      scrollbar-width: none;
    }

    .file-list {
      list-style: none;
      padding: 0;
      margin: 10px 15px 0px 15px;
      height: auto;
      padding-right: 10px;
      scrollbar-width: none;
      overflow: auto;
    }

    .file-list::-webkit-scrollbar {
        display: none;
    }

    .file-list li {
      margin: 8px 0;
      padding: 6px 12px;
      background-color: rgba(96, 95, 95, 0.05);
      border-radius: 6px;
      transition:
          transform 0.15s ease,
          background-color 0.2s ease;
      will-change: transform;
      font-weight: 500;
      font-size: 14px;
      font-family: 'Poppins', monospace;
      color: #eeebebbe;
      cursor: pointer;
      height: auto;
      scrollbar-width: none;
      overflow-y: auto;
      border: none;
      box-shadow: none;
      outline: none;
    }

    .file-list li.folder-open { background-color: var(--tile-bg-hover); }

    .file-list li:hover:not(:has(.folder-open-button:hover)) {
      background-color: var(--tile-bg-hover);
    }

    .file-list li.highlighted {
      background: var(--tile-highlight);
      color: var(--text-main);
      transition: background 0.3s ease;
      font-weight: 600;
      cursor: pointer;
      border: none;
      box-shadow: none;
      outline: none;
    }

    .file-list li.highlighted:hover {
      background: rgba(128, 128, 128, 0.12);
      transition: transform 0.15s ease, background 0.1s ease-in;
      will-change: transform;
      border: none;
      box-shadow: none;
    }

    .file-entry {
      display: flex;
      align-items: center;
      justify-content: space-between;
      overflow-y: auto;
      scrollbar-width: none;
    }

    .file-entry a {
      color: var(--text-main);
      text-decoration: none;
      display: inline-block;
      transform-style: preserve-3d;
      transition: transform 0.2s ease, color 0.2s ease;
      will-change: transform;
    }
    .file-entry a:hover { color: rgba(253, 255, 255, 0.72); }

    .file-entry img,
    .folder-entry img {
      height: 20px;
      vertical-align: middle;
      margin-right: 8px;
    }
    .file-entry img:hover,
    .folder-entry img:hover {
      filter: brightness(1.2);
      transform: scale(1.1);
      transition: transform 0.2s ease, filter 0.2s ease;
      cursor: pointer;
    }
    li.folder-open .folder-entry img {
      filter: brightness(1.3);
      transform: scale(1.1);
    }

    .file-size-tag,
    .file-count-tag {
      background: var(--badge-bg);
      color: var(--badge-text);
      padding: 2px 8px;
      border-radius: 5px;
      font-size: 12px;
      white-space: nowrap;
      font-family: 'Poppins', monospace;
      font-weight: 600;
    }
    .file-size-tag { margin-left: auto; }
    .file-count-tag { margin-left: 6px; }

    .folder-entry {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      color: var(--text-main);
      position: relative;
      scrollbar-width: none;
    }
    .folder-entry:hover { color: rgba(253, 255, 255, 0.75); cursor: pointer; }

    .folder-entry span.folder-name {
      display: inline-block;
      transform-style: preserve-3d;
      transition: transform 0.2s ease;
      will-change: transform;
    }

    .folder-arrow {
      width: 12px;
      height: 12px;
      margin-right: 6px;
      transition: transform 0.2s ease;
      fill: var(--arrow-color);
      flex-shrink: 0;
    }
    .folder-arrow.open { transform: rotate(90deg); }

    .folder-open-button {
      background: var(--btn-bg);
      border: none;
      padding: 6px;
      margin-left: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.25s ease, transform 0.3s ease, opacity 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: none;
      position: relative;
    }
    .folder-open-button:hover {
      background: var(--btn-bg-hover);
      filter: brightness(1.2);
      transform: translateX(0.5px) scale(1.1);
    }
    .folder-open-button svg { width: 18px; height: 18px; }
    .folder-open-button svg path:first-child { fill: rgba(2, 161, 50, 0.8); opacity: 0.7; }
    .folder-open-button svg path.arrow-part { fill: rgba(2, 161, 50, 0.8); opacity: 0.7; }

    .custom-tooltip {
        opacity: 0;
        position: absolute;
        bottom: 20px;
        left: 10%;
        transform: translateX(-50%);
        background: rgba(50, 50, 50, 0.6);
        color: #a1a1a179;
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 12px;
        white-space: nowrap;
        font-weight: 700;
        font-family: 'Poppins', monospace;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.05);
        z-index: 9999;
        width: auto;
        height: auto;
        scale: 65%;
    }
    .folder-open-button:hover .custom-tooltip {
      opacity: 0;
      pointer-events: auto;
      transition-delay: 180ms;
    }
  
    #elden-section .manager-disclaimer {
      font-family: 'Rubik', sans-serif;
      display: flex;
      align-items: center;
      max-width: fit-content;
      margin: 50px auto 0;
      padding: 0.75rem 1rem;
      background: rgba(173, 173, 173, 0.05);
      backdrop-filter: blur(4px);
      border-radius: 12px;
      font-size: 12px;
      line-height: 1.3;
      color: #999;
      gap: 0.75rem;
    }
    .manager-disclaimer {
      font-family: 'Rubik', sans-serif;
      display: flex;
      align-items: center;
      max-width: fit-content;
      margin: 50px auto 0;
      padding: 0.75rem 1rem;
      background: rgba(173, 173, 173, 0.05);
      backdrop-filter: blur(4px);
      border-radius: 12px;
      font-size: 12px;
      line-height: 1.3;
      color: #999;
      gap: 0.75rem;
    }
    .manager-disclaimer-icon-custom {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border: 2px solid rgba(120, 120, 120, 0.5);
      border-radius: 50%;
      color: rgba(140, 140, 140, 0.7);
      font-weight: bold;
      font-size: 18px;
      opacity: 0.5;
      filter: blur(0.3px);
      backdrop-filter: blur(2px);
      box-shadow: 0 0 2px rgba(0, 0, 0, 0.2);
    }

    #docModal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    
    #docModal > div {
      position: relative;
      width: 90vw;
      max-width: 1200px;
      height: 85vh;
      background: rgba(40, 40, 40, 0.95);
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    #closeModal {
      position: absolute;
      top: 8px;
      right: 15px;
      background: rgba(255, 51, 51, 0.8);
      border: none;
      color: white;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      padding: 7px 10px;
      border-radius: 8px;
      z-index: 10000;
      transition: background 0.2s ease, transform 0.1s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    #closeModal:hover {
      background: rgba(255, 51, 51, 1);
      transform: scale(1.05);
    }
    
    #docFrame {
      flex: 1;
      border: none;
      border-radius: 8px;
      margin: 10px;
      margin-top: 50px;
      background: white;
    }

    .elden-custom-size { width: 500px !important; height: auto !important; }
    .spacer { height: 40px; }
    
    @media (max-width: 768px) {
      #docModal > div {
        width: 95vw;
        height: 90vh;
      }
      
      #docModal {
        padding: 10px;
      }
      
      #closeModal {
        top: 10px;
        right: 10px;
        padding: 6px 10px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div id="bg-tw" class="bg-layer" aria-hidden="true"></div>
  <div id="bg-er" class="bg-layer" aria-hidden="true"></div>

  <div id="particles-js"></div>

  <div class="content">
    <section id="tw-section">
      <img id="tw-customIcon" class="elden-custom-size"
           src="https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/TotalWar-button_icon.png"
           alt="Total War Icon" />
           <div class="filelist-frame">
              <ul id="tw-fileList" class="file-list">Loading...</ul>
           </div>

            <div class="manager-disclaimer">
                <div class="manager-disclaimer-icon-custom">!</div>
                <div>
                  Scroll down to see more
                </div>
            </div>
    </section>

    <div class="spacer"></div><div class="spacer"></div><div class="spacer"></div>
    <div class="spacer"></div><div class="spacer"></div><div class="spacer"></div>
    <div class="spacer"></div><div class="spacer"></div><div class="spacer"></div>
    <div class="spacer"></div>

    <section id="elden-section">
      <img id="customIcon" class="elden-custom-size"
           src="https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/EldenRing_Logo.png"
           alt="Elden Ring Icon" />
           <div class="filelist-frame">
             <ul id="fileList" class="file-list">Loading...</ul>
           </div>

      <div id="docModal">
        <div>
          <button id="closeModal">Ã—</button>
          <iframe id="docFrame" src=""></iframe>
        </div>
      </div>

      <div class="manager-disclaimer">
        <div class="manager-disclaimer-icon-custom">!</div>
        <div>
          I haven't developed any of the content listed here.<br>
          They are created and owned by third parties.
        </div>
      </div>
    </section>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <script>
    const twColors = ['#ffaa00', '#ff6a00', '#8a8a8a'];
    const erColors = ['#9ab97d', '#6c8f5a', '#a1ffe1'];

    function pauseParticles() {
      if (window.pJSDom && pJSDom[0] && pJSDom[0].pJS) {
        pJSDom[0].pJS.particles.move.enable = false;
        pJSDom[0].pJS.fn.particlesRefresh();
      }
    }
    function resumeParticles() {
      if (window.pJSDom && pJSDom[0] && pJSDom[0].pJS) {
        pJSDom[0].pJS.particles.move.enable = true;
        pJSDom[0].pJS.fn.particlesRefresh();
      }
    }

    function initializeParticles(colors) {
      if (window.pJSDom && pJSDom[0]) {
        pJSDom[0].pJS.particles.color.value = colors;
        pJSDom[0].pJS.fn.particlesRefresh();
      } else {
        particlesJS('particles-js', {
          particles: {
            number: { value: 90, density: { enable: true, value_area: 700 } },
            color: { value: colors },
            shape: { type: 'circle' },
            opacity: { value: 0.6, random: true, anim: { enable: true, speed: 1.2, opacity_min: 0.2, sync: false } },
            size: { value: 4, random: true, anim: { enable: true, speed: 4, size_min: 1, sync: false } },
            line_linked: { enable: false },
            move: { enable: true, speed: 0.35, direction: 'top', random: true, straight: false, out_mode: 'out', bounce: false }
          },
          interactivity: { detect_on: 'canvas', events: { onhover: { enable: false }, onclick: { enable: false }, resize: true } },
          retina_detect: true
        });
      }
    }
    initializeParticles(twColors);

    (function setupBackgroundCrossfade() {
      const erBg = document.getElementById('bg-er');
      const erSection = document.getElementById('elden-section');
      const TRANSITION_HEIGHT = 700;
      let usingEldenColors = false;

      function onScroll() {
        const rect = erSection.getBoundingClientRect();
        let progress = 1 - Math.min(Math.max(rect.top / TRANSITION_HEIGHT, 0), 1);
        erBg.style.opacity = progress.toFixed(3);

        if (progress > 0.6 && !usingEldenColors) {
          initializeParticles(erColors);
          usingEldenColors = true;
        } else if (progress < 0.3 && usingEldenColors) {
          initializeParticles(twColors);
          usingEldenColors = false;
        }
      }
      window.addEventListener('scroll', onScroll, { passive: true });
      window.addEventListener('resize', onScroll);
      onScroll();
    })();

    function formatBytes(bytes) {
      const sizes = ["Bytes", "KB", "MB", "GB", "TB"];
      if (bytes === 0) return "0 Bytes";
      const i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)), 10);
      return parseFloat((bytes / Math.pow(1024, i)).toFixed(1)) + " " + sizes[i];
    }

    function rgbToHsl(r, g, b) {
      r /= 255; g /= 255; b /= 255;
      const max = Math.max(r, g, b), min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;
      if (max === min) { h = s = 0; }
      else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }
      return { h, s, l };
    }
    function hslToRgb(h, s, l) {
      let r, g, b;
      if (s === 0) { r = g = b = l; }
      else {
        const hue2rgb = (p, q, t) => {
          if (t < 0) t += 1;
          if (t > 1) t -= 1;
          if (t < 1/6) return p + (q - p) * 6 * t;
          if (t < 1/2) return q;
          if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
          return p;
        };
        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
      }
      return { r: Math.round(r*255), g: Math.round(g*255), b: Math.round(b*255) };
    }
    function adjustLightness({ r, g, b }, delta = 0.15) {
      const { h, s, l } = rgbToHsl(r, g, b);
      const nl = Math.max(0, Math.min(1, l + delta));
      return hslToRgb(h, s, nl);
    }
    function rgbaStr({ r, g, b }, a) {
      return `rgba(${r}, ${g}, ${b}, ${a})`;
    }

    function getAverageColorFromImage(src) {
      return new Promise((resolve, reject) => {
        const img = new Image();
        img.crossOrigin = "anonymous";
        img.onload = () => {
          try {
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d", { willReadFrequently: true });
            const w = 24, h = 24;
            canvas.width = w; canvas.height = h;
            ctx.drawImage(img, 0, 0, w, h);
            const { data } = ctx.getImageData(0, 0, w, h);
            let r = 0, g = 0, b = 0, count = 0;
            for (let i = 0; i < data.length; i += 8) {
              const a = data[i + 3];
              if (a < 64) continue;
              r += data[i];
              g += data[i + 1];
              b += data[i + 2];
              count++;
            }
            if (!count) return reject("no_pixels");
            resolve({ r: Math.round(r / count), g: Math.round(g / count), b: Math.round(b / count) });
          } catch (e) { reject(e); }
        };
        img.onerror = () => reject("load_error");
        img.src = src;
      });
    }

    function applyGradientToItemFromSrc(li, src, fallbackKey, folderGradientFallback = {}) {
      getAverageColorFromImage(src).then(base => {
        const light = adjustLightness(base, +0.18);
        const dark = adjustLightness(base, -0.18);
        li.style.backgroundImage = `linear-gradient(135deg, ${rgbaStr(light, 0.18)} 0%, ${rgbaStr(dark, 0.35)} 100%)`;
        li.style.border = `1px solid ${rgbaStr(dark, 0.22)}`;
        li.style.backdropFilter = 'blur(1px)';
      }).catch(() => {
        if (fallbackKey && folderGradientFallback[fallbackKey]) {
          li.style.backgroundImage = folderGradientFallback[fallbackKey];
          li.style.border = `1px solid rgba(255,255,255,0.06)`;
        } else {
          li.style.backgroundImage = `linear-gradient(135deg, rgba(120,120,120,0.12), rgba(60,60,60,0.24))`;
          li.style.border = `1px solid rgba(255,255,255,0.05)`;
        }
      });
    }

    function isDriveDoc(mimeType) {
      return mimeType && mimeType.startsWith('application/vnd.google-apps');
    }

    function getDownloadUrl(file, apiKey) {
      if (file.webContentLink) return file.webContentLink;
      return `https://www.googleapis.com/drive/v3/files/${file.id}?alt=media&key=${apiKey}`;
    }

    function shouldShowDownloadButtonForFile({ file, folderId, path, includeList }) {
      if (!includeList || includeList.length === 0) return false;
      const keyByPath = path ? `${path}${file.name}` : file.name;
      const keyById = `${folderId}/${file.name}`;

      return includeList.includes(file.name)
          || includeList.includes(file.id)
          || includeList.includes(keyByPath)
          || includeList.includes(keyById);
    }

    function isExcludedDownloadFile({ file, folderId, path, excludeList }) {
    if (!excludeList || excludeList.length === 0) return false;

    const keyByPath = path ? `${path}${file.name}` : file.name;
    const keyById = `${folderId}/${file.name}`;

    return excludeList.includes(file.name)
        || excludeList.includes(file.id)
        || excludeList.includes(keyByPath)
        || excludeList.includes(keyById);
    }

    async function listFilesInFolder({
      folderId,
      container,
      path = "",
      apiKey,
      customIcons = {},
      customFolderIcons = {},
      highlightFiles = [],
      colorizeFiles = [],
      folderGradientFallback = {},
      showDownloadButtonAtRoot = true,
      excludePartsFolders = [],
      downloadButtonFiles = [],
      excludeDownloadFiles = []
    }) {
      container.innerHTML = "";

      const url = `https://www.googleapis.com/drive/v3/files?q='${folderId}'+in+parents+and+trashed=false&key=${apiKey}&fields=files(id,name,mimeType,webViewLink,webContentLink,iconLink,size)`;
      const res = await fetch(url);
      const data = await res.json();

      if (!data.files || data.files.length === 0) {
        const li = document.createElement("li");
        li.textContent = "No files found.";
        container.appendChild(li);
        return;
      }

      const files = data.files.filter(f => f.mimeType !== "application/vnd.google-apps.folder");
      const folders = data.files.filter(f => f.mimeType === "application/vnd.google-apps.folder");

      files.sort((a, b) => {
        const aTop = highlightFiles.includes(a.name);
        const bTop = highlightFiles.includes(b.name);
        if (aTop && !bTop) return -1;
        if (bTop && !aTop) return 1;
        return a.name.localeCompare(b.name, undefined, { numeric: true });
      });
      folders.sort((a, b) => a.name.localeCompare(b.name, undefined, { numeric: true }));

      // Files
      for (const file of files) {
        const li = document.createElement("li");
        if (highlightFiles.includes(file.name)) li.classList.add("highlighted");

        const link = document.createElement("a");
        link.href = file.webViewLink;
        link.target = "_blank";

        link.addEventListener('mousemove', (e) => {
          const rect = link.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          const midX = rect.width / 2;
          const midY = rect.height / 2;
          const rotateX = ((y - midY) / midY) * 2;
          const rotateY = ((x - midX) / midX) * 2;
          link.style.transform = `translateX(1.5px) rotateX(${-rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
        });
        link.addEventListener('mouseleave', () => {
          link.style.transform = 'translateX(0px) rotateX(0deg) rotateY(0deg) scale(1)';
        });

        const icon = document.createElement("img");
        const iconKey = `${folderId}/${file.name}`;
        icon.src = customIcons[iconKey] || customIcons[file.name] || file.iconLink;
        icon.alt = "";

        if (colorizeFiles.includes(file.name)) {
          applyGradientToItemFromSrc(li, icon.src);
        }

        link.appendChild(icon);
        link.appendChild(document.createTextNode(file.name));

        const fileEntry = document.createElement("div");
        fileEntry.className = "file-entry";
        fileEntry.appendChild(link);

        if (file.size) {
          const sizeTag = document.createElement("span");
          sizeTag.className = "file-size-tag";
          sizeTag.textContent = formatBytes(parseInt(file.size, 10));
          fileEntry.appendChild(sizeTag);
        }

      const includeButton = shouldShowDownloadButtonForFile({
        file,
        folderId,
        path,
        includeList: downloadButtonFiles
      });

      const excludeButton = isExcludedDownloadFile({
        file,
        folderId,
        path,
        excludeList: excludeDownloadFiles
      });

      if (!isDriveDoc(file.mimeType) && (includeButton || (!path && showDownloadButtonAtRoot)) && !excludeButton) {
        const downloadBtn = document.createElement("button");
        downloadBtn.className = "folder-open-button";

        const tooltip = document.createElement("span");
        tooltip.className = "custom-tooltip";
        tooltip.textContent = "Download";
        downloadBtn.appendChild(tooltip);

        const btnIcon = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        btnIcon.setAttribute("width", "16");
        btnIcon.setAttribute("height", "16");
        btnIcon.setAttribute("viewBox", "0 0 24 24");
        btnIcon.setAttribute("fill", "none");

        const trayPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
        trayPath.setAttribute("d", "M5 20h14a1 1 0 0 0 1-1v-3h-2v2H6v-2H4v3a1 1 0 0 0 1 1z");
        trayPath.setAttribute("fill", "rgba(255, 255, 255, 0.15)");

        const arrowPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
        arrowPath.setAttribute("d", "M12 3v10.17l3.59-3.58L17 11l-5 5-5-5 1.41-1.41L11 13.17V3h2z");
        arrowPath.setAttribute("fill", "rgba(255, 255, 255, 0.35)");
        arrowPath.setAttribute("class", "arrow-part");

        btnIcon.appendChild(trayPath);
        btnIcon.appendChild(arrowPath);
        downloadBtn.appendChild(btnIcon);

        downloadBtn.onclick = () => {
          const dl = getDownloadUrl(file, apiKey);
          window.open(dl, "_blank");
        };

        fileEntry.appendChild(downloadBtn);
      }

      li.appendChild(fileEntry);
      container.appendChild(li);
    }

      for (const folder of folders) {
        const li = document.createElement("li");

        const folderLink = document.createElement("div");
        folderLink.className = "folder-entry";
        folderLink.style.cursor = "pointer";

        const leftWrapper = document.createElement("div");
        leftWrapper.style.display = "flex";
        leftWrapper.style.alignItems = "center";

        const arrow = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        arrow.setAttribute("viewBox", "0 0 24 24");
        arrow.setAttribute("class", "folder-arrow");
        arrow.innerHTML = `<path d="M9 5l7 7-7 7"/>`;

        const icon = document.createElement("img");
        icon.crossOrigin = "anonymous";
        const iconSrc = customFolderIcons[folder.id] || folder.iconLink;
        icon.src = iconSrc;
        icon.alt = "";

        const nameSpan = document.createElement("span");
        nameSpan.className = "folder-name";
        nameSpan.textContent = folder.name;

        const rightWrapper = document.createElement("div");
        rightWrapper.style.display = "flex";
        rightWrapper.style.alignItems = "center";
        rightWrapper.style.gap = "1px";

        const sizeTag = document.createElement("span");
        sizeTag.className = "file-size-tag";
        sizeTag.textContent = "...";

        const excludeParts = excludePartsFolders.includes(folder.id) || excludePartsFolders.includes(folder.name);
        let countTag = null;
        if (!excludeParts) {
          countTag = document.createElement("span");
          countTag.className = "file-count-tag";
          countTag.textContent = "";
        }

        const folderBtn = document.createElement("button");
        const folderExcluded =
            excludeDownloadFiles.includes(folder.id) ||
            excludeDownloadFiles.includes(folder.name);

        if (!folderExcluded) {
            rightWrapper.appendChild(folderBtn);
        }
        folderBtn.className = "folder-open-button";
        const tooltip = document.createElement("span");
        tooltip.className = "custom-tooltip";
        tooltip.textContent = "Download";
        folderBtn.appendChild(tooltip);
        folderBtn.onclick = (e) => {
          e.stopPropagation();
          window.open(`https://drive.google.com/drive/folders/${folder.id}`, "_blank");
        };

        const btnIcon = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        btnIcon.setAttribute("width", "16");
        btnIcon.setAttribute("height", "16");
        btnIcon.setAttribute("viewBox", "0 0 24 24");
        btnIcon.setAttribute("fill", "none");

        const trayPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
        trayPath.setAttribute("d", "M5 20h14a1 1 0 0 0 1-1v-3h-2v2H6v-2H4v3a1 1 0 0 0 1 1z");
        trayPath.setAttribute("fill", "rgba(255, 255, 255, 0.15)");

        const arrowPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
        arrowPath.setAttribute("d", "M12 3v10.17l3.59-3.58L17 11l-5 5-5-5 1.41-1.41L11 13.17V3h2z");
        arrowPath.setAttribute("fill", "rgba(255, 255, 255, 0.35)");
        arrowPath.setAttribute("class", "arrow-part");

        btnIcon.appendChild(trayPath);
        btnIcon.appendChild(arrowPath);
        folderBtn.appendChild(btnIcon);

        leftWrapper.appendChild(arrow);
        leftWrapper.appendChild(icon);
        leftWrapper.appendChild(nameSpan);

        rightWrapper.appendChild(sizeTag);
        if (countTag) rightWrapper.appendChild(countTag);
        if (!excludeDownloadFiles.includes(folder.id) &&
            !excludeDownloadFiles.includes(folder.name)) {
        rightWrapper.appendChild(folderBtn);
        }

        folderLink.appendChild(leftWrapper);
        folderLink.appendChild(rightWrapper);
        li.appendChild(folderLink);

        applyGradientToItemFromSrc(li, iconSrc, folder.id, folderGradientFallback);

        const subList = document.createElement("ul");
        subList.className = "file-list";
        subList.style.marginLeft = "20px";
        subList.style.height = "auto";
        subList.style.maxHeight = "480px";
        subList.style.display = "none";
        li.appendChild(subList);

        folderLink.addEventListener("click", async () => {
          if (subList.childElementCount === 0) {
            await listFilesInFolder({
              folderId: folder.id,
              container: subList,
              path: `${path}${folder.name}/`,
              apiKey,
              customIcons,
              customFolderIcons,
              highlightFiles,
              colorizeFiles,
              folderGradientFallback,
              showDownloadButtonAtRoot: false,
              excludePartsFolders,
              downloadButtonFiles,
              excludeDownloadFiles
            });
          }
          const isOpen = subList.style.display === "block";
          subList.style.display = isOpen ? "none" : "block";
          arrow.classList.toggle("open", !isOpen);
          li.classList.toggle("folder-open", !isOpen);
        });

        nameSpan.addEventListener('mousemove', (e) => {
          const rect = nameSpan.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          const midX = rect.width / 2;
          const midY = rect.height / 2;
          const rotateX = ((y - midY) / midY) * 2;
          const rotateY = ((x - midX) / midX) * 2;
          nameSpan.style.transform = `translateX(1.5px) rotateX(${-rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
        });
        nameSpan.addEventListener('mouseleave', () => {
          nameSpan.style.transform = 'translateX(0px) rotateX(0deg) rotateY(0deg) scale(1)';
        });

        fetch(`https://www.googleapis.com/drive/v3/files?q='${folder.id}'+in+parents+and+trashed=false&fields=files(size,mimeType)&key=${apiKey}`)
          .then(res => res.json())
          .then(data => {
            if (!data.files) return;
            const fileItems = data.files.filter(f => f.mimeType !== "application/vnd.google-apps.folder");
            const fileCount = fileItems.length;
            const totalSize = fileItems
              .filter(f => f.size)
              .reduce((sum, f) => sum + parseInt(f.size, 10), 0);

            sizeTag.textContent = formatBytes(totalSize);
            if (countTag) {
                countTag.textContent = `${fileCount} Part${fileCount !== 1 ? "s" : ""}`;
             }
          });

        container.appendChild(li);
      }
    }

    function attachDocPreview(listElement) {
      if (!listElement) return;
      listElement.addEventListener("click", function (e) {
        const target = e.target;
        let link = target.tagName === "A" ? target : target.closest("a");
        if (!link) return;

        const url = link.href;
        if (url.includes("docs.google.com/document")) {
          e.preventDefault();
          const fileIdMatch = url.match(/[-\w]{25,}/);
          const fileId = fileIdMatch ? fileIdMatch[0] : null;
          if (fileId) {
            const embedUrl = `https://docs.google.com/document/d/${fileId}/preview`;
            document.getElementById("docFrame").src = embedUrl;
            document.getElementById("docModal").style.display = "flex";
          } else {
            alert("Could not determine Google Doc ID.");
          }
        }
      });
    }

    document.getElementById("closeModal").addEventListener("click", function () {
      document.getElementById("docModal").style.display = "none";
      document.getElementById("docFrame").src = "";
    });

    // Close modal when clicking outside the modal content
    document.getElementById("docModal").addEventListener("click", function (e) {
      if (e.target === this) {
        document.getElementById("docModal").style.display = "none";
        document.getElementById("docFrame").src = "";
      }
    });

    // Close modal with Escape key
    document.addEventListener("keydown", function (e) {
      if (e.key === "Escape" && document.getElementById("docModal").style.display === "flex") {
        document.getElementById("docModal").style.display = "none";
        document.getElementById("docFrame").src = "";
      }
    });

    (function initializeFileLists() {
      const apiKey = "AIzaSyDqtsRN35V1JnmfIY9hTsn_Ej4aSipsK4M";

      const twRootFolderId = "10v2qU6Q01tZkyc7EuqGjz_YF_JA-AAiG";
      const twContainer = document.getElementById("tw-fileList");
      listFilesInFolder({
        folderId: twRootFolderId,
        container: twContainer,
        apiKey,
        customIcons: {
            "Seven Kingdoms.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/SevenKingdoms.ico",
            "Total War Skyrim.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TotalWarSkyrim.ico",
            "Northern Kingdoms Remastered.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/NorthernKingdomsRemastered.ico",
            "Attila Extra Modifications.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TotalWarAttilaExtras.ico",
            "Medieval Kingdoms 1212AD Part 1.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/MedievelKingdoms1212AD.ico",
            "Medieval Kingdoms 1212AD Part 2.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/MedievelKingdoms1212AD.ico",
            "Medieval Kingdoms 1212AD Part 3.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/MedievelKingdoms1212AD.ico",
            "Medieval Kingdoms 1212AD Part 4.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/MedievelKingdoms1212AD.ico",
            "Medieval Kingdoms 1212AD Part 5.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/MedievelKingdoms1212AD.ico",
            "Ancient Empires Part 1.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/AnchientEmpires.ico",
            "Ancient Empires Part 2.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/AnchientEmpires.ico",
            "Ancient Empires Part 3.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/AnchientEmpires.ico",
            "Ancient Empires Part 4.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/AnchientEmpires.ico",
            "The Dawnless Days Part 1.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TheDawnlessDays.ico",
            "The Dawnless Days Part 2.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TheDawnlessDays.ico",
            "The Dawnless Days Part 3.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TheDawnlessDays.ico",
            "Nova Attila Part 1.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/NovaAttila.ico",
            "Nova Attila Part 2.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/NovaAttila.ico",

            "Empire Total War II v4.5.rar": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/EmpireII.ico",
            "1h__AJylt5ZhfY_iN8d-lGqg-KuReRTdj/Empire 2 Generals Part 1.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Empire2General.ico",
            "1h__AJylt5ZhfY_iN8d-lGqg-KuReRTdj/Empire 2 Generals Part 2.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Empire2General.ico",
            "1h__AJylt5ZhfY_iN8d-lGqg-KuReRTdj/Empire 2 Generals Part 3.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Empire2General.ico",

            "ACW2 The American Civil War.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/ACW2.ico",
            "Field Command Napoleon v8.0.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/FieldCommand.ico",
            "Grand Battle Mod v2.6.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/GrandBattle.ico",
            "Napoleonic Total War III.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/NapoleonicTotalWar3.ico",

            "War of the Gods.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/WarofTheGods.ico",
            "Radious Total War.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/RadiousTotalWar.ico",
            "Medieval 1100AD.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Medieval1100AD.ico",
            "Divide et Impera.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/DivideetImpera.ico",
            "Rome II Extra Modifications.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TotalWarRome2Extras.ico",
            "Para Bellum Part 1.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/ParaBellum.ico",
            "Para Bellum Part 2.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/ParaBellum.ico",

            "Last Alliance.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/LastAlliance.ico",
            "Pike & Shot II.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/PikeAndShotII.ico",
            "Rise of Empires.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/RiseOfEmpires.ico",
            "Dragon Empire Part 1.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/DragonEmpire.ico",
            "Dragon Empire Part 2.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/DragonEmpire.ico",
            "Carlist Wars.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TotalFotS.ico",
            "Scramble of the Far East.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TotalFotS.ico",

            "Thrones Extra Modifications.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TotalWarThronesExtras.ico",
            "Age of Arthur.exe": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/AgeOfArthur.ico",
        },
        customFolderIcons: {
            "1aKdtU4523e-51o_hm7-QeHFVxIFJvzlv": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/MedievelKingdoms1212AD.ico",
            "1Y44ajJaNdEea5QLvUnQr3nLnmLxBHZSv": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/AnchientEmpires.ico",
            "1iNfu1THAgULCd3pGUVsQCNlnTHKx-JQY": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TheDawnlessDays.ico",
            "1ElTsIpzKxZHZoMm9rxDfv6-dZoPLPosV": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/SevenKingdoms.ico",
            "1NHAPD9Si2PM058Vkam_80h-okIFs31S3": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/NovaAttila.ico",
            "15r5NfzciWGfClpGvmT5ydfH4fDbScVAl": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Attila.ico",
            "1IsBsstw8TYRZ4FP_cl0ydaVLWRRjVbam": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/TotalWar_Empire.png",
            "1NiLKxsM1tZUbYjYoquZ2cYVMWh-zAprN": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/TotalWar_Napoleon.png",
            "14p-1KeG4OB5uYIWqH8yRScpyXRj0IaEb": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Rome2.ico",
            "1zYVOwQN--y78iTUnku67DyABh5maAfV_": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/TotalWar_Shogun2.png",
            "1vizoQOE_gq9rK9LgrxeNgFoikw75AX2h": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Thrones.ico",
            "1h__AJylt5ZhfY_iN8d-lGqg-KuReRTdj": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Empire2General.ico",
            "1P9wPHHxDGGt3tUrEyukiYBf-_YIMJayF": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/ParaBellum.ico",
            "1MsU5Q9-uQ23a0anq3ZsH4RdZ-0CkiAiU": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/DragonEmpire.ico",
            "1MsU5Q9-uQ23a0anq3ZsH4RdZ-0CkiAiU": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/DragonEmpire.ico",
            "1QkAve8DnUDfCRi3EBpFqqXHddXtiTfmX": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/TotalFotS.ico",
        },
        highlightFiles: [
          "Attila Extra Modifications.exe",
          "Rome II Extra Modifications.exe",
          "Thrones Extra Modifications.exe"
        ],
        colorizeFiles: [
          "Attila Extra Modifications.exe",
          "Rome II Extra Modifications.exe",
          "Thrones Extra Modifications.exe"
        ],
        excludePartsFolders: [
          "15r5NfzciWGfClpGvmT5ydfH4fDbScVAl",
          "1IsBsstw8TYRZ4FP_cl0ydaVLWRRjVbam",
          "1NiLKxsM1tZUbYjYoquZ2cYVMWh-zAprN",
          "14p-1KeG4OB5uYIWqH8yRScpyXRj0IaEb",
          "1zYVOwQN--y78iTUnku67DyABh5maAfV_",
          "1vizoQOE_gq9rK9LgrxeNgFoikw75AX2h",
          "1QkAve8DnUDfCRi3EBpFqqXHddXtiTfmX"
        ],
        folderGradientFallback: {},
        downloadButtonFiles: [
          "Attila Extra Modifications.exe",
          "Northern Kingdoms Remastered.exe",
          "Seven Kingdoms.exe",
          "Total War Skyrim.exe",
          "Empire Total War II v4.5.rar",
          "ACW2 The American Civil War.exe",
          "Field Command Napoleon v8.0.exe",
          "Grand Battle Mod v2.6.exe",
          "Napoleonic Total War III.exe",
          "Rome II Extra Modifications.exe",
          "Divide et Impera.exe",
          "Medieval 1100AD.exe",
          "Radious Total War.exe",
          "War of the Gods.exe",
          "Last Alliance.exe",
          "Pike & Shot II.exe",
          "Rise of Empires.exe",
          "Thrones Extra Modifications.exe",
          "Age of Arthur.exe",
          "Carlist Wars.exe",
          "Scramble of the Far East.exe"
        ],
        excludeDownloadFiles: [
          "15r5NfzciWGfClpGvmT5ydfH4fDbScVAl",
          "1IsBsstw8TYRZ4FP_cl0ydaVLWRRjVbam",
          "1NiLKxsM1tZUbYjYoquZ2cYVMWh-zAprN",
          "14p-1KeG4OB5uYIWqH8yRScpyXRj0IaEb",
          "1zYVOwQN--y78iTUnku67DyABh5maAfV_",
          "1vizoQOE_gq9rK9LgrxeNgFoikw75AX2h",
          "1QkAve8DnUDfCRi3EBpFqqXHddXtiTfmX"
        ],
        showDownloadButtonAtRoot: true
      });
      attachDocPreview(twContainer);

      const erRootFolderId = "1QAOW3qPeIHWinvsQmECyfccTZjavI7mA";
      const erContainer = document.getElementById("fileList");
      listFilesInFolder({
        folderId: erRootFolderId,
        container: erContainer,
        apiKey,
        customIcons: {
          "Convergence (2.2.3).zip": "https://justkaarlo.github.io/JustKaarlo-Google-Site/resources/icons/GoogleDriveIcons/Custom/Convergence.ico"
        },
        customFolderIcons: {},
        highlightFiles: [
          "Convergence (2.2.3).zip"
        ],
        colorizeFiles: [
          "Convergence (2.2.3).zip"
        ],
        excludePartsFolders: [""],
        folderGradientFallback: {},
        downloadButtonFiles: [],
        excludeDownloadFiles: [],
        showDownloadButtonAtRoot: true
      });
      attachDocPreview(erContainer);
    })();
  </script>
</body>
</html>
